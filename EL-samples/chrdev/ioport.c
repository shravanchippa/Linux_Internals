/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 
*                                                                      *
* ModuleName         :  ioport.o                                       *
* SourceName         :  ioport.c                                       *
*                                                                      *
* Description        : writing & reading from port                     *
*                                                                      *
* Programmer         :---------                                        *
* Date               : 27/4/2006                                       *
*                                                                      *
*----------------------------------------------------------------------*
* Notes:                                                               *
*                                                                      *
*                                                                      *
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */

/*----------------------------------------------------------------------
 ************************** Include File *******************************
 *----------------------------------------------------------------------*/

#include <linux/module.h>
#include <asm/io.h>

/*---------------------------------------------------------------------
 ************************** D E F I N E********************************
 *--------------------------------------------------------------------*/
#define LPT 0x378

/*---------------------------------------------------------------------
 ************************** INIT MODULE *******************************
 *--------------------------------------------------------------------*/

int ioport_init(void)
{
  printk ("START OF INIT MODULE\n");
  outb(0x40, LPT);		/* switch on LED */
  return 0;
}

/*---------------------------------------------------------------------
 ************************** CLEANUP MODULE ****************************
 *--------------------------------------------------------------------*/

void ioport_exit(void)
{
  unsigned char Status;
  printk (" I am in clean up module\n");
  outb(0x00, LPT);		/* switch off LED */
  Status = inb (LPT+1);
  printk("Status = %02x\n", Status);
}

module_init(ioport_init);
module_exit(ioport_exit);

MODULE_LICENSE("GPL");

